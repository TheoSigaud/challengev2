import Head from 'next/head'
import dynamic from 'next/dynamic'
import {  useEffect } from 'react';

const Chart = dynamic(() => import('react-apexcharts'), { ssr: false });import React, { useState } from 'react';
import AdminLayout from '@/components/layouts/Admin';
import Checkout from '@/components/announcement/Checkout';
import { set } from 'lodash';

export default function Admin() {

    interface PaymentData {
        date: string;
        count: number;
    }

    interface Series{
        name: string;
        data: number[];
    }

    // useeffect with fetch data route payementByDate 
    // const [paymentData, setPaymentData] = useState([]);
    const [options, setOptions] = useState({});
    const [series, setSeries] = useState<Series[]>([]);

    
    useEffect( () => {
    document.body.classList.add("bg-custom-light-blue");
    },[]);

    useEffect(() => {
         fetch(`${process.env.NEXT_PUBLIC_CLIENT_API}/announcement/paymentByDate`, {
                method: 'GET',
            })
                .then(response => {
                    const statusCode = response.status;
                    return response.json();
                })
                .then((data) => {
                    setOptions({
                        chart: {
                            id: "basic-bar"
                        },
                        xaxis: {
                            categories: data.map( (data: PaymentData) => data.date),
                        }
                    });

                    setSeries([
                         {
                        name: 'Nombre de paiements',
                        data: data.map( (data: PaymentData) => data.count),
                        }
                    ]);
                    
                }).catch((error) => {
                console.log(error);
            });
    }, []);

    return (
        <>
            <Head>
                <title>Create Next App</title>
                <meta name="description" content="Generated by create next app"/>
                <meta name="viewport" content="width=device-width, initial-scale=1"/>
                <link rel="icon" href="/favicon.ico"/>
            </Head>
            <AdminLayout>
                <div className="p-4 sm:ml-64">
                    <div className="grid gap-4 xl:grid-cols-2 2xl:grid-cols-3">
                        <div
                            className="p-4 bg-white border border-gray-200 rounded-lg shadow-sm 2xl:col-span-2 dark:border-gray-700 sm:p-6 dark:bg-gray-800">
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex-shrink-0">
                                    <h3 className="text-base font-light text-gray-500 dark:text-gray-400">Nombre de paiement par date</h3>
                                </div>
                               
                            </div>
                            {(typeof window !== 'undefined') &&

                                <Chart
                                options={options}
                                series={series}
                                type="bar"
                                width="500"
                            />
                            }
                        </div>
                    </div>

                </div>



            </AdminLayout>
        </>
    )
}


